{% extends "base.html" %}
{% block title %}{{ cliente.nome }} - CRM{% endblock %}

{% block content %}

<h1 class="section-title">ğŸ‘¤ {{ cliente.nome }}</h1>

<div class="mb-4 d-flex gap-2">
  <a href="{{ url_for('planner') }}" class="btn btn-primary btn-rounded">ğŸ“… Planner</a>
  <a href="{{ url_for('detalhe_cliente_novo', id=cliente.id) }}" class="btn btn-warning btn-rounded">âœ¨ Detalhes Completos</a>
  <a href="{{ url_for('add_mesa', id=cliente.id) }}" class="btn btn-primary btn-rounded">â• Nova Mesa</a>
  <a href="{{ url_for('add_ocorrencia', id=cliente.id) }}" class="btn btn-primary btn-rounded">â• Nova OcorrÃªncia</a>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="card card-accent hover-lift">
      <div class="card-header">ğŸ“‹ InformaÃ§Ãµes do Cliente</div>
      <div class="card-body">
        <p><strong>Email:</strong> {{ cliente.email }}</p>
        <p><strong>Telefone:</strong> {{ cliente.telefone }}</p>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card card-accent hover-lift">
      <div class="card-header">ğŸ“Š Resumo</div>
      <div class="card-body">
        <p><strong>Total de Mesas:</strong> <span class="badge badge-primary">{{ cliente.mesas|length }}</span></p>
        <p><strong>Total de OcorrÃªncias:</strong> <span class="badge badge-danger">{{ cliente.ocorrencias|length }}</span></p>
      </div>
    </div>
  </div>
</div>

<div class="row mt-4">
  <div class="col-md-6">
    <div class="card card-accent">
      <div class="card-header">ğŸ’¼ Mesas de NegÃ³cio</div>
      <div class="card-body">
        {% if cliente.mesas %}
        <div class="table-responsive">
          <table class="table table-sm">
            <tbody>
              {% for mesa in cliente.mesas %}
              <tr>
                <td>
                  <strong>{{ mesa.topico }}</strong><br>
                  <small class="text-muted">{{ mesa.situacao }}</small>
                </td>
                <td class="text-end">
                  <a href="{{ url_for('detalhe_mesa', id=mesa.id) }}" class="btn btn-sm btn-primary">Ver</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% else %}
        <p class="text-muted">Nenhuma mesa de negÃ³cio registrada.</p>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card card-accent">
      <div class="card-header">âš ï¸ OcorrÃªncias</div>
      <div class="card-body">
        {% if cliente.ocorrencias %}
        <div class="table-responsive">
          <table class="table table-sm">
            <tbody>
              {% for o in cliente.ocorrencias %}
              <tr>
                <td>
                  <strong>{{ o.topico }}</strong><br>
                  <small class="text-muted">{{ o.status }}</small>
                </td>
                <td class="text-end">
                  <a href="{{ url_for('detalhe_ocorrencia', id=o.id) }}" class="btn btn-sm btn-primary">Ver</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% else %}
        <p class="text-muted">Nenhuma ocorrÃªncia registrada.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% endblock %}

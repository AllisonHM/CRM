{% extends "base.html" %}
{% block title %}Ocorrências{% endblock %}

{% block content %}

<h1 class="section-title">⚠️ Ocorrências</h1>

<div class="table-responsive">
    <table class="table table-crm">
        <thead>
            <tr>
                <th>ID</th>
                <th>Cliente</th>
                <th>Tópico</th>
                <th>Situação</th>
                <th>Ações</th>
            </tr>
        </thead>

        <tbody>
            {% for o in ocorrencias %}
            <tr>
                <td>{{ o.id }}</td>

                <td>
                    {{ (o.cliente.nome if o.cliente else (o.cliente_nome if o.cliente_nome else '—')) }}
                </td>

                <td>{{ o.topico or '—' }}</td>

                <td>
                    {% if o.situacao == 'Ativa' %}
                        <span class="badge-sucesso">Ativa</span>
                    {% elif o.situacao == 'Pendente' %}
                        <span class="badge-pendente">Pendente</span>
                    {% else %}
                        <span class="badge-outro">{{ o.situacao }}</span>
                    {% endif %}
                </td>

                <td>
                    {% if o.situacao == 'Ativo' %}
                        <a class="btn-ver" href="{{ url_for('detalhe_ocorrencia', id=o.id) }}">
                            Ver / Editar
                        </a>
                    {% else %}
                        <button class="btn-ver" style="opacity:0.4;" disabled>Sem ação</button>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
